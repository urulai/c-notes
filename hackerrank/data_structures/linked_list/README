Need to refactor the code.
